<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - classlib/Collections/Collection.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome-ie7.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/es-analysis/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>classlib/Collections/Collection.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">120.79</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">1048</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">101.96</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">10.61</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">SCScript.install(function(sc) {
  &quot;use strict&quot;;

  require(&quot;../Core/Object&quot;);

  var $ = sc.lang.$;
  var $nil   = $.nil;
  var $true  = $.true;
  var $false = $.false;
  var $int0  = $.int0;
  var $int1  = $.int1;
  var SCArray = $(&quot;Array&quot;);

  sc.lang.klass.refine(&quot;Collection&quot;, function(builder) {
    builder.addClassMethod(&quot;newFrom&quot;, {
      args: &quot;aCollection&quot;
    }, function($aCollection) {
      var $newCollection;

      $newCollection = this.new($aCollection.size());
      $aCollection.do($.Func(function($item) {
        return $newCollection.add($item);
      }));

      return $newCollection;
    });

    builder.addClassMethod(&quot;with&quot;, {
      args: &quot;*args&quot;
    }, function($$args) {
      var $newColl;

      $newColl = this.new($$args.size());
      $newColl.addAll($$args);

      return $newColl;
    });

    builder.addClassMethod(&quot;fill&quot;, {
      args: &quot;size; function&quot;
    }, function($size, $function) {
      var $obj;
      var size, i;

      if ($size.isSequenceableCollection().__bool__()) {
        return this.fillND($size, $function);
      }

      $obj = this.new($size);

      size = $size.__int__();
      for (i = 0; i &lt; size; ++i) {
        $obj.add($function.value($.Integer(i)));
      }

      return $obj;
    });

    builder.addClassMethod(&quot;fill2D&quot;, {
      args: &quot;rows; cols; function&quot;
    }, function($rows, $cols, $function) {
      var $this = this, $obj, $obj2, $row, $col;
      var rows, cols, i, j;

      $obj = this.new($rows);

      rows = $rows.__int__();
      cols = $cols.__int__();

      for (i = 0; i &lt; rows; ++i) {
        $row = $.Integer(i);
        $obj2 = $this.new($cols);
        for (j = 0; j &lt; cols; ++j) {
          $col = $.Integer(j);
          $obj2 = $obj2.add($function.value($row, $col));
        }
        $obj = $obj.add($obj2);
      }

      return $obj;
    });

    builder.addClassMethod(&quot;fill3D&quot;, {
      args: &quot;planes; rows; cols; function&quot;
    }, function($planes, $rows, $cols, $function) {
      var $this = this, $obj, $obj2, $obj3, $plane, $row, $col;
      var planes, rows, cols, i, j, k;

      $obj = this.new($planes);

      planes = $planes.__int__();
      rows   = $rows  .__int__();
      cols   = $cols  .__int__();

      for (i = 0; i &lt; planes; ++i) {
        $plane = $.Integer(i);
        $obj2 = $this.new($rows);
        for (j = 0; j &lt; rows; ++j) {
          $row = $.Integer(j);
          $obj3 = $this.new($cols);
          for (k = 0; k &lt; cols; ++k) {
            $col = $.Integer(k);
            $obj3 = $obj3.add($function.value($plane, $row, $col));
          }
          $obj2 = $obj2.add($obj3);
        }
        $obj = $obj.add($obj2);
      }

      return $obj;
    });

    var fillND = function($this, $dimensions, $function, $args) {
      var $n, $obj, $argIndex;

      $n = $dimensions.$(&quot;first&quot;);
      $obj = $this.new($n);
      $argIndex = $args.size();
      $args = $args [&quot;++&quot;] ($int0);

      if ($dimensions.size().__int__() &lt;= 1) {
        $n.do($.Func(function($i) {
          return $obj.add($function.valueArray($args.put($argIndex, $i)));
        }));
      } else {
        $dimensions = $dimensions.$(&quot;drop&quot;, [ $int1 ]);
        $n.do($.Func(function($i) {
          $obj = $obj.add(fillND($this, $dimensions, $function, $args.put($argIndex, $i)));
          return $obj;
        }));
      }

      return $obj;
    };

    builder.addClassMethod(&quot;fillND&quot;, {
      args: &quot;dimensions; function&quot;
    }, function($dimensions, $function) {
      return fillND(this, $dimensions, $function, $.Array([]));
    });

    builder.addMethod(&quot;@&quot;, function($index) {
      return this.at($index);
    });

    builder.addMethod(&quot;==&quot;, function($aCollection) {
      var $res = null;

      if ($aCollection.class() !== this.class()) {
        return $false;
      }
      if (this.size() !== $aCollection.size()) {
        return $false;
      }
      this.do($.Func(function($item) {
        if (!$aCollection.$(&quot;includes&quot;, [ $item ]).__bool__()) {
          $res = $false;
          this.break();
        }
        return $nil;
      }));

      return $res || $true;
    });

    // TODO: implements hash

    builder.addMethod(&quot;species&quot;, function() {
      return SCArray;
    });

    builder.subclassResponsibility(&quot;do&quot;);

    // TODO: implements iter

    builder.addMethod(&quot;size&quot;, function() {
      var tally = 0;

      this.do($.Func(function() {
        tally += 1;
        return $nil;
      }));

      return $.Integer(tally);
    });

    builder.addMethod(&quot;flatSize&quot;, function() {
      return this.sum($.Func(function($_) {
        return $_.$(&quot;flatSize&quot;);
      }));
    });

    builder.addMethod(&quot;isEmpty&quot;, function() {
      return $.Boolean(this.size().__int__() === 0);
    });

    builder.addMethod(&quot;notEmpty&quot;, function() {
      return $.Boolean(this.size().__int__() !== 0);
    });

    builder.addMethod(&quot;asCollection&quot;);
    builder.addMethod(&quot;isCollection&quot;, sc.TRUE);

    builder.subclassResponsibility(&quot;add&quot;);

    builder.addMethod(&quot;addAll&quot;, {
      args: &quot;aCollection&quot;
    }, function($aCollection) {
      var $this = this;

      $aCollection.asCollection().do($.Func(function($item) {
        return $this.add($item);
      }));

      return this;
    });

    builder.subclassResponsibility(&quot;remove&quot;);

    builder.addMethod(&quot;removeAll&quot;, {
      args: &quot;list&quot;
    }, function($list) {
      var $this = this;

      $list.do($.Func(function($item) {
        return $this.remove($item);
      }));

      return this;
    });

    builder.addMethod(&quot;removeEvery&quot;, {
      args: &quot;list&quot;
    }, function($list) {
      this.removeAllSuchThat($.Func(function($_) {
        return $list.$(&quot;includes&quot;, [ $_ ]);
      }));
      return this;
    });

    builder.addMethod(&quot;removeAllSuchThat&quot;, function($function) {
      var $this = this, $removedItems, $copy;

      $removedItems = this.class().new();
      $copy = this.copy();
      $copy.do($.Func(function($item) {
        if ($function.value($item).__bool__()) {
          $this.remove($item);
          $removedItems = $removedItems.add($item);
        }
        return $nil;
      }));

      return $removedItems;
    });

    builder.addMethod(&quot;atAll&quot;, {
      args: &quot;keys&quot;
    }, function($keys) {
      var $this = this;

      return $keys.$(&quot;collect&quot;, [ $.Func(function($index) {
        return $this.at($index);
      }) ]);
    });

    builder.addMethod(&quot;putEach&quot;, {
      args: &quot;keys; values&quot;
    }, function($keys, $values) {
      var keys, values, i, imax;

      $keys   = $keys.asArray();
      $values = $values.asArray();

      keys   = $keys._;
      values = $values._;
      for (i = 0, imax = keys.length; i &lt; imax; ++i) {
        this.put(keys[i], values[i % values.length]);
      }

      return this;
    });

    builder.addMethod(&quot;includes&quot;, {
      args: &quot;item1&quot;
    }, function($item1) {
      var $res = null;

      this.do($.Func(function($item2) {
        if ($item1 === $item2) {
          $res = $true;
          this.break();
        }
        return $nil;
      }));

      return $res || $false;
    });

    builder.addMethod(&quot;includesEqual&quot;, {
      args: &quot;item1&quot;
    }, function($item1) {
      var $res = null;

      this.do($.Func(function($item2) {
        if ($item1 [&quot;==&quot;] ($item2).__bool__()) {
          $res = $true;
          this.break();
        }
        return $nil;
      }));

      return $res || $false;
    });

    builder.addMethod(&quot;includesAny&quot;, {
      args: &quot;aCollection&quot;
    }, function($aCollection) {
      var $this = this, $res = null;

      $aCollection.do($.Func(function($item) {
        if ($this.includes($item).__bool__()) {
          $res = $true;
          this.break();
        }
        return $nil;
      }));

      return $res || $false;
    });

    builder.addMethod(&quot;includesAll&quot;, {
      args: &quot;aCollection&quot;
    }, function($aCollection) {
      var $this = this, $res = null;

      $aCollection.do($.Func(function($item) {
        if (!$this.includes($item).__bool__()) {
          $res = $false;
          this.break();
        }
        return $nil;
      }));

      return $res || $true;
    });

    builder.addMethod(&quot;matchItem&quot;, {
      args: &quot;item&quot;
    }, function($item) {
      return this.includes($item);
    });

    builder.addMethod(&quot;collect&quot;, function($function) {
      return this.collectAs($function, this.species());
    });

    builder.addMethod(&quot;select&quot;, function($function) {
      return this.selectAs($function, this.species());
    });

    builder.addMethod(&quot;reject&quot;, function($function) {
      return this.rejectAs($function, this.species());
    });

    builder.addMethod(&quot;collectAs&quot;, {
      args: &quot;function; class&quot;
    }, function($function, $class) {
      var $res;

      $res = $class.new(this.size());
      this.do($.Func(function($elem, $i) {
        return $res.add($function.value($elem, $i));
      }));

      return $res;
    });

    builder.addMethod(&quot;selectAs&quot;, {
      args: &quot;function; class&quot;
    }, function($function, $class) {
      var $res;

      $res = $class.new(this.size());
      this.do($.Func(function($elem, $i) {
        if ($function.value($elem, $i).__bool__()) {
          $res = $res.add($elem);
        }
        return $nil;
      }));

      return $res;
    });

    builder.addMethod(&quot;rejectAs&quot;, {
      args: &quot;function; class&quot;
    }, function($function, $class) {
      var $res;

      $res = $class.new(this.size());
      this.do($.Func(function($elem, $i) {
        if (!$function.value($elem, $i).__bool__()) {
          $res = $res.add($elem);
        }
        return $nil;
      }));

      return $res;
    });

    builder.addMethod(&quot;detect&quot;, function($function) {
      var $res = null;

      this.do($.Func(function($elem, $i) {
        if ($function.value($elem, $i).__bool__()) {
          $res = $elem;
          this.break();
        }
        return $nil;
      }));

      return $res || $nil;
    });

    builder.addMethod(&quot;detectIndex&quot;, function($function) {
      var $res = null;

      this.do($.Func(function($elem, $i) {
        if ($function.value($elem, $i).__bool__()) {
          $res = $i;
          this.break();
        }
        return $nil;
      }));
      return $res || $nil;
    });

    builder.addMethod(&quot;doMsg&quot;, function() {
      var args = arguments;
      this.do($.Func(function($item) {
        return $item.perform.apply($item, args);
      }));
      return this;
    });

    builder.addMethod(&quot;collectMsg&quot;, function() {
      var args = arguments;
      return this.collect($.Func(function($item) {
        return $item.perform.apply($item, args);
      }));
    });

    builder.addMethod(&quot;selectMsg&quot;, function() {
      var args = arguments;
      return this.select($.Func(function($item) {
        return $item.perform.apply($item, args);
      }));
    });

    builder.addMethod(&quot;rejectMsg&quot;, function() {
      var args = arguments;
      return this.reject($.Func(function($item) {
        return $item.perform.apply($item, args);
      }));
    });

    builder.addMethod(&quot;detectMsg&quot;, {
      args: &quot;selector; *args&quot;
    }, function($selector, $$args) {
      return this.detect($.Func(function($item) {
        return $item.performList($selector, $$args);
      }));
    });

    builder.addMethod(&quot;detectIndexMsg&quot;, {
      args: &quot;selector; *args&quot;
    }, function($selector, $$args) {
      return this.detectIndex($.Func(function($item) {
        return $item.performList($selector, $$args);
      }));
    });

    builder.addMethod(&quot;lastForWhich&quot;, function($function) {
      var $res = null;
      this.do($.Func(function($elem, $i) {
        if ($function.value($elem, $i).__bool__()) {
          $res = $elem;
        } else {
          this.break();
        }
        return $nil;
      }));
      return $res || $nil;
    });

    builder.addMethod(&quot;lastIndexForWhich&quot;, function($function) {
      var $res = null;
      this.do($.Func(function($elem, $i) {
        if ($function.value($elem, $i).__bool__()) {
          $res = $i;
        } else {
          this.break();
        }
        return $nil;
      }));
      return $res || $nil;
    });

    builder.addMethod(&quot;inject&quot;, {
      args: &quot;thisValue; function&quot;
    }, function($thisValue, $function) {
      var $nextValue;
      $nextValue = $thisValue;
      this.do($.Func(function($item, $i) {
        $nextValue = $function.value($nextValue, $item, $i);
        return $nextValue;
      }));
      return $nextValue;
    });

    builder.addMethod(&quot;injectr&quot;, {
      args: &quot;thisValue; function&quot;
    }, function($thisValue, $function) {
      var $this = this, size, $nextValue;
      size = this.size().__int__();
      $nextValue = $thisValue;
      this.do($.Func(function($item, $i) {
        $item = $this.at($.Integer(--size));
        $nextValue = $function.value($nextValue, $item, $i);
        return $nextValue;
      }));
      return $nextValue;
    });

    builder.addMethod(&quot;count&quot;, function($function) {
      var sum = 0;
      this.do($.Func(function($elem, $i) {
        if ($function.value($elem, $i).__bool__()) {
          sum++;
        }
        return $nil;
      }));
      return $.Integer(sum);
    });

    builder.addMethod(&quot;occurrencesOf&quot;, {
      args: &quot;obj&quot;
    }, function($obj) {
      var sum = 0;
      this.do($.Func(function($elem) {
        if ($elem [&quot;==&quot;] ($obj).__bool__()) {
          sum++;
        }
        return $nil;
      }));
      return $.Integer(sum);
    });

    builder.addMethod(&quot;any&quot;, function($function) {
      var $res = null;
      this.do($.Func(function($elem, $i) {
        if ($function.value($elem, $i).__bool__()) {
          $res = $true;
          this.break();
        }
        return $nil;
      }));
      return $res || $false;
    });

    builder.addMethod(&quot;every&quot;, function($function) {
      var $res = null;
      this.do($.Func(function($elem, $i) {
        if (!$function.value($elem, $i).__bool__()) {
          $res = $false;
          this.break();
        }
        return $nil;
      }));
      return $res || $true;
    });

    builder.addMethod(&quot;sum&quot;, {
      args: &quot;function&quot;
    }, function($function) {
      var $sum;
      $sum = $int0;
      if ($function === $nil) {
        this.do($.Func(function($elem) {
          $sum = $sum [&quot;+&quot;] ($elem);
          return $sum;
        }));
      } else {
        this.do($.Func(function($elem, $i) {
          $sum = $sum [&quot;+&quot;] ($function.value($elem, $i));
          return $sum;
        }));
      }
      return $sum;
    });

    builder.addMethod(&quot;mean&quot;, function($function) {
      return this.sum($function) [&quot;/&quot;] (this.size());
    });

    builder.addMethod(&quot;product&quot;, {
      args: &quot;function&quot;
    }, function($function) {
      var $product;
      $product = $int1;
      if ($function === $nil) {
        this.do($.Func(function($elem) {
          $product = $product [&quot;*&quot;] ($elem);
          return $product;
        }));
      } else {
        this.do($.Func(function($elem, $i) {
          $product = $product [&quot;*&quot;] ($function.value($elem, $i));
          return $product;
        }));
      }
      return $product;
    });

    builder.addMethod(&quot;sumabs&quot;, function() {
      var $sum;
      $sum = $int0;
      this.do($.Func(function($elem) {
        if ($elem.isSequenceableCollection().__bool__()) {
          $elem = $elem.at($int0);
        }
        $sum = $sum [&quot;+&quot;] ($elem.abs());
        return $sum;
      }));
      return $sum;
    });

    builder.addMethod(&quot;maxItem&quot;, {
      args: &quot;function&quot;
    }, function($function) {
      var $maxValue, $maxElement;

      $maxValue   = $nil;
      $maxElement = $nil;
      if ($function === $nil) {
        this.do($.Func(function($elem) {
          if ($maxElement === $nil) {
            $maxElement = $elem;
          } else if ($elem &gt; $maxElement) {
            $maxElement = $elem;
          }
          return $nil;
        }));
      } else {
        this.do($.Func(function($elem, $i) {
          var $val;
          if ($maxValue === $nil) {
            $maxValue = $function.value($elem, $i);
            $maxElement = $elem;
          } else {
            $val = $function.value($elem, $i);
            if ($val &gt; $maxValue) {
              $maxValue = $val;
              $maxElement = $elem;
            }
          }
          return $nil;
        }));
      }

      return $maxElement;
    });

    builder.addMethod(&quot;minItem&quot;, {
      args: &quot;function&quot;
    }, function($function) {
      var $minValue, $minElement;

      $minValue   = $nil;
      $minElement = $nil;
      if ($function === $nil) {
        this.do($.Func(function($elem) {
          if ($minElement === $nil) {
            $minElement = $elem;
          } else if ($elem &lt; $minElement) {
            $minElement = $elem;
          }
          return $nil;
        }));
      } else {
        this.do($.Func(function($elem, $i) {
          var $val;
          if ($minValue === $nil) {
            $minValue = $function.value($elem, $i);
            $minElement = $elem;
          } else {
            $val = $function.value($elem, $i);
            if ($val &lt; $minValue) {
              $minValue = $val;
              $minElement = $elem;
            }
          }
          return $nil;
        }));
      }

      return $minElement;
    });

    builder.addMethod(&quot;maxIndex&quot;, {
      args: &quot;function&quot;
    }, function($function) {
      var $maxValue, $maxIndex;

      $maxValue = $nil;
      $maxIndex = $nil;
      if ($function === $nil) {
        this.do($.Func(function($elem, $index) {
          if ($maxValue === $nil) {
            $maxValue = $elem;
            $maxIndex = $index;
          } else if ($elem &gt; $maxValue) {
            $maxValue = $elem;
            $maxIndex = $index;
          }
          return $nil;
        }));
      } else {
        this.do($.Func(function($elem, $i) {
          var $val;
          if ($maxValue === $nil) {
            $maxValue = $function.value($elem, $i);
            $maxIndex = $i;
          } else {
            $val = $function.value($elem, $i);
            if ($val &gt; $maxValue) {
              $maxValue = $val;
              $maxIndex = $i;
            }
          }
          return $nil;
        }));
      }

      return $maxIndex;
    });

    builder.addMethod(&quot;minIndex&quot;, {
      args: &quot;function&quot;
    }, function($function) {
      var $maxValue, $minIndex;

      $maxValue = $nil;
      $minIndex = $nil;
      if ($function === $nil) {
        this.do($.Func(function($elem, $index) {
          if ($maxValue === $nil) {
            $maxValue = $elem;
            $minIndex = $index;
          } else if ($elem &lt; $maxValue) {
            $maxValue = $elem;
            $minIndex = $index;
          }
          return $nil;
        }));
      } else {
        this.do($.Func(function($elem, $i) {
          var $val;
          if ($maxValue === $nil) {
            $maxValue = $function.value($elem, $i);
            $minIndex = $i;
          } else {
            $val = $function.value($elem, $i);
            if ($val &lt; $maxValue) {
              $maxValue = $val;
              $minIndex = $i;
            }
          }
          return $nil;
        }));
      }

      return $minIndex;
    });

    builder.addMethod(&quot;maxValue&quot;, {
      args: &quot;function&quot;
    }, function($function) {
      var $maxValue, $maxElement;

      $maxValue   = $nil;
      $maxElement = $nil;
      this.do($.Func(function($elem, $i) {
        var $val;
        if ($maxValue === $nil) {
          $maxValue = $function.value($elem, $i);
          $maxElement = $elem;
        } else {
          $val = $function.value($elem, $i);
          if ($val &gt; $maxValue) {
            $maxValue = $val;
            $maxElement = $elem;
          }
        }
        return $nil;
      }));

      return $maxValue;
    });

    builder.addMethod(&quot;minValue&quot;, {
      args: &quot;function&quot;
    }, function($function) {
      var $minValue, $minElement;

      $minValue   = $nil;
      $minElement = $nil;
      this.do($.Func(function($elem, $i) {
        var $val;
        if ($minValue === $nil) {
          $minValue = $function.value($elem, $i);
          $minElement = $elem;
        } else {
          $val = $function.value($elem, $i);
          if ($val &lt; $minValue) {
            $minValue = $val;
            $minElement = $elem;
          }
        }
        return $nil;
      }));

      return $minValue;
    });

    builder.addMethod(&quot;maxSizeAtDepth&quot;, {
      args: &quot;rank&quot;
    }, function($rank) {
      var rank, maxsize = 0;

      rank = $rank.__num__();
      if (rank === 0) {
        return this.size();
      }

      this.do($.Func(function($sublist) {
        var sz;
        if ($sublist.isCollection().__bool__()) {
          sz = $sublist.maxSizeAtDepth($.Integer(rank - 1));
        } else {
          sz = 1;
        }
        if (sz &gt; maxsize) {
          maxsize = sz;
        }
        return $nil;
      }));

      return $.Integer(maxsize);
    });

    builder.addMethod(&quot;maxDepth&quot;, {
      args: &quot;max=1&quot;
    }, function($max) {
      var $res;

      $res = $max;
      this.do($.Func(function($elem) {
        if ($elem.isCollection().__bool__()) {
          $res = $res.max($elem.maxDepth($max.__inc__()));
        }
        return $nil;
      }));

      return $res;
    });

    builder.addMethod(&quot;deepCollect&quot;, {
      args: &quot;depth=1; function; index=0; rank=0&quot;
    }, function($depth, $function, $index, $rank) {
      if ($depth === $nil) {
        $rank = $rank.__inc__();
        return this.collect($.Func(function($item, $i) {
          return $item.deepCollect($depth, $function, $i, $rank);
        }));
      }
      if ($depth.__num__() &lt;= 0) {
        return $function.value(this, $index, $rank);
      }
      $depth = $depth.__dec__();
      $rank  = $rank.__inc__();

      return this.collect($.Func(function($item, $i) {
        return $item.deepCollect($depth, $function, $i, $rank);
      }));
    });

    builder.addMethod(&quot;deepDo&quot;, {
      args: &quot;depth=1; function; index=0; rank=0&quot;
    }, function($depth, $function, $index, $rank) {
      if ($depth === $nil) {
        $rank = $rank.__inc__();
        return this.do($.Func(function($item, $i) {
          return $item.deepDo($depth, $function, $i, $rank);
        }));
      }
      if ($depth.__num__() &lt;= 0) {
        $function.value(this, $index, $rank);
        return this;
      }
      $depth = $depth.__dec__();
      $rank  = $rank.__inc__();

      return this.do($.Func(function($item, $i) {
        return $item.deepDo($depth, $function, $i, $rank);
      }));
    });

    builder.addMethod(&quot;invert&quot;, {
      args: &quot;axis&quot;
    }, function($axis) {
      var $index;

      if (this.isEmpty().__bool__()) {
        return this.species().new();
      }
      if ($axis !== $nil) {
        $index = $axis.$(&quot;*&quot;, [ $.Integer(2) ]);
      } else {
        $index = this.minItem().$(&quot;+&quot;, [ this.maxItem() ]);
      }

      return $index [&quot;-&quot;] (this);
    });

    builder.addMethod(&quot;sect&quot;, {
      args: &quot;that&quot;
    }, function($that) {
      var $result;

      $result = this.species().new();
      this.do($.Func(function($item) {
        if ($that.$(&quot;includes&quot;, [ $item ]).__bool__()) {
          $result = $result.add($item);
        }
        return $nil;
      }));

      return $result;
    });

    builder.addMethod(&quot;union&quot;, {
      args: &quot;that&quot;
    }, function($that) {
      var $result;

      $result = this.copy();
      $that.do($.Func(function($item) {
        if (!$result.includes($item).__bool__()) {
          $result = $result.add($item);
        }
        return $nil;
      }));

      return $result;
    });

    builder.addMethod(&quot;difference&quot;, {
      args: &quot;that&quot;
    }, function($that) {
      return this.copy().removeAll($that);
    });

    builder.addMethod(&quot;symmetricDifference&quot;, {
      args: &quot;that&quot;
    }, function($that) {
      var $this = this, $result;

      $result = this.species().new();
      $this.do($.Func(function($item) {
        if (!$that.includes($item).__bool__()) {
          $result = $result.add($item);
        }
        return $nil;
      }));
      $that.do($.Func(function($item) {
        if (!$this.includes($item).__bool__()) {
          $result = $result.add($item);
        }
        return $nil;
      }));

      return $result;
    });

    builder.addMethod(&quot;isSubsetOf&quot;, {
      args: &quot;that&quot;
    }, function($that) {
      return $that.$(&quot;includesAll&quot;, [ this ]);
    });

    builder.addMethod(&quot;asArray&quot;, function() {
      return SCArray.new(this.size()).addAll(this);
    });

    builder.addMethod(&quot;asBag&quot;, function() {
      return $(&quot;Bag&quot;).new(this.size()).addAll(this);
    });

    builder.addMethod(&quot;asList&quot;, function() {
      return $(&quot;List&quot;).new(this.size()).addAll(this);
    });

    builder.addMethod(&quot;asSet&quot;, function() {
      return $(&quot;Set&quot;).new(this.size()).addAll(this);
    });

    builder.addMethod(&quot;asSortedList&quot;, function($function) {
      return $(&quot;SortedList&quot;).new(this.size(), $function).addAll(this);
    });

    // TODO: implements powerset
    // TODO: implements flopDict
    // TODO: implements histo
    // TODO: implements printAll
    // TODO: implements printcsAll
    // TODO: implements dumpAll
    // TODO: implements printOn
    // TODO: implements storeOn
    // TODO: implements storeItemsOn
    // TODO: implements printItemsOn
    // TODO: implements writeDef
    // TODO: implements writeInputSpec
    // TODO: implements case
    // TODO: implements makeEnvirValPairs

    builder.addMethod(&quot;asString&quot;, function() {
      var items = [];
      this.do($.Func(function($elem) {
        items.push($elem.__str__());
        return $nil;
      }));
      return $.String(
        this.__className + &quot;[ &quot; + items.join(&quot;, &quot;) + &quot; ]&quot;
      );
    });
  });
});</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
